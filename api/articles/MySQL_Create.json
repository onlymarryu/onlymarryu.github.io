{"title":"MySQL基础","uid":"4a207b7e885fdbcca8129599135e5f2e","slug":"MySQL_Create","date":"2022-10-08T07:10:28.016Z","updated":"2022-10-07T16:16:13.341Z","comments":true,"path":"api/articles/MySQL_Create.json","keywords":"java","cover":[],"content":"<h1 id=\"mysql安装\"><a class=\"markdownIt-Anchor\" href=\"#mysql安装\">#</a> MySQL 安装</h1>\n<h2 id=\"1-卸载原来的版本\"><a class=\"markdownIt-Anchor\" href=\"#1-卸载原来的版本\">#</a> 1、卸载原来的版本</h2>\n<h3 id=\"1-查看mysql的安装情况\"><a class=\"markdownIt-Anchor\" href=\"#1-查看mysql的安装情况\">#</a> 1、查看 mysql 的安装情况</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<img src=\"/:/post/MySQL_Create/1570605325400.png\" class=\"\" width=\"1570605325400\">\n<h3 id=\"2-删除上图安装的软件\"><a class=\"markdownIt-Anchor\" href=\"#2-删除上图安装的软件\">#</a> 2、删除上图安装的软件</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql57-community-release-el5-7.noarch\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-server-5.7.18-1.el5.x86_64\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-client-5.7.18-1.el5.x86_64\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-5.7.18-1.el5.x86_64\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-common-5.7.18-1.el5.x86_64\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-5.7.18-1.el5.x86_64\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-ev</span> <span class=\"token parameter variable\">--nodeps</span> mysql-community-libs-compat-5.7.18-1.el5.x86_64\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"3-都删除成功之后查找相关的mysql的文件\"><a class=\"markdownIt-Anchor\" href=\"#3-都删除成功之后查找相关的mysql的文件\">#</a> 3、都删除成功之后，查找相关的 mysql 的文件</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> mysql<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<img src=\"/:/post/MySQL_Create/1570605553095.png\" class=\"\" width=\"1570605553095\">\n<h3 id=\"4-删除全部文件\"><a class=\"markdownIt-Anchor\" href=\"#4-删除全部文件\">#</a> 4、删除全部文件</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /etc/selinux/targeted/active/modules/100/mysql\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /root/mysql/data/mysql\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /var/lib/mysql/mysql\n<span class=\"token function\">rm</span> <span class=\"token parameter variable\">-rf</span> /usr/share/mysql<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"5-再次执行命令\"><a class=\"markdownIt-Anchor\" href=\"#5-再次执行命令\">#</a> 5、再次执行命令</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-qa</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token parameter variable\">-i</span> mysql\n<span class=\"token comment\">#如果没有显式则表示卸载完成</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h2 id=\"2-删除mariadb-libs不可省略\"><a class=\"markdownIt-Anchor\" href=\"#2-删除mariadb-libs不可省略\">#</a> 2、删除 mariadb-libs (不可省略)</h2>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 检查mariadb-libs</span>\n<span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb\n<span class=\"token comment\"># 卸载mariadb-libs</span>\nyum remove <span class=\"token parameter variable\">-y</span> mariadb-libs\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"3-安装mysql\"><a class=\"markdownIt-Anchor\" href=\"#3-安装mysql\">#</a> 3、安装 MySQL</h2>\n<h3 id=\"1输入\"><a class=\"markdownIt-Anchor\" href=\"#1输入\">#</a> 1，输入</h3>\n<p>wegt <a href=\"https://dev.mysql.com/get/mysql%E7%89%88%E6%9C%AC%E5%8F%B7-community-release-el%E5%A4%A7%E7%89%88%E6%9C%AC-%E5%B0%8F%E7%89%88%E6%9C%AC.noarch.rpm\">https://dev.mysql.com/get/mysql 版本号 - community-release-el 大版本 - 小版本.noarch.rpm</a></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://dev.mysql.com/get/mysql57-community-release-el5-7.noarch.rpm\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"2-安装数据源\"><a class=\"markdownIt-Anchor\" href=\"#2-安装数据源\">#</a> 2、安装数据源</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> mysql57-community-release-el5-7.noarch.rpm\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"3-查看mysql源是否安装成功\"><a class=\"markdownIt-Anchor\" href=\"#3-查看mysql源是否安装成功\">#</a> 3、查看 mysql 源是否安装成功</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum repolist enabled <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"mysql.*-community.*\"</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"4-安装数据库\"><a class=\"markdownIt-Anchor\" href=\"#4-安装数据库\">#</a> 4、安装数据库</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span>  mysql-community-server\n\n\n\n<span class=\"token comment\"># 如果过期可以在运行安装程序之前导入密钥</span>\n<span class=\"token function\">rpm</span> <span class=\"token parameter variable\">--import</span> https://repo.mysql.com/RPM-GPG-KEY-mysql-2022<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"5-启动mysql\"><a class=\"markdownIt-Anchor\" href=\"#5-启动mysql\">#</a> 5、启动 mysql</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># centos7</span>\nsystemctl restart mysqld\nsystemctl status mysqld\n\n\n<span class=\"token comment\"># centos6</span>\n<span class=\"token function\">service</span> mysqld start\n<span class=\"token function\">service</span> mysqld status\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"6-显示mysql的随机密码\"><a class=\"markdownIt-Anchor\" href=\"#6-显示mysql的随机密码\">#</a> 6、显示 mysql 的随机密码</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">grep</span> <span class=\"token string\">'temporary password'</span> /var/log/mysqld.log\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<img src=\"/:/post/MySQL_Create/image-20220827193405451.png\" class=\"\" title=\"image-20220827193405451\">\n<h3 id=\"7-登录并修改mysql密码\"><a class=\"markdownIt-Anchor\" href=\"#7-登录并修改mysql密码\">#</a> 7、登录并修改 mysql 密码</h3>\n<p>登录：mysql -u root -p     然后输入上面生成的密码</p>\n<p><strong><em>修改自定义密码，设置自己想要的密码</em></strong></p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- ALTER USER 'root'@'localhost' IDENTIFIED BY '密码';</span>\n\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'localhost'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><strong><em>失败了的话就修改策略，将策略降低一下就可以了</em></strong></p>\n<p>查看密码策略：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SHOW</span> VARIABLES <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%validate_password%'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>修改密码策略</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 修改密码长度：（长度）</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 修改密码等级：（等级）</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password<span class=\"token punctuation\">.</span>policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"4-其他配置\"><a class=\"markdownIt-Anchor\" href=\"#4-其他配置\">#</a> 4、其他配置</h2>\n<h3 id=\"1开机自启\"><a class=\"markdownIt-Anchor\" href=\"#1开机自启\">#</a> 1. 开机自启</h3>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 开机启动</span>\nsystemctl <span class=\"token builtin class-name\">enable</span> mysql\n<span class=\"token comment\"># 关闭自动启动</span>\nsystemctl disable mysqld\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"2远程连接\"><a class=\"markdownIt-Anchor\" href=\"#2远程连接\">#</a> 2. 远程连接</h3>\n<h4 id=\"方法一-创建一个用户-支持远程连接\"><a class=\"markdownIt-Anchor\" href=\"#方法一-创建一个用户-支持远程连接\">#</a> 方法一、创建一个用户 支持远程连接</h4>\n<p>①登录 ：mysql -u root -p</p>\n<p>②创建用户： create user ‘aaa’@’%’ identified by ‘123456’;</p>\n<p>③授权所有权限给 user 这个新用户 ：grant all on <em>.</em> to ‘aaa’@’%’;</p>\n<p>④退出 mysql：quit;</p>\n<h4 id=\"方法二-设置root用户支持远程连接\"><a class=\"markdownIt-Anchor\" href=\"#方法二-设置root用户支持远程连接\">#</a> 方法二、设置 root 用户支持远程连接</h4>\n<p>①登录：mysql -u root -p （ 注：系统提示输入数据库 root 用户的密码，输入完成后即进入 mysql 控制台，这个命令的第一个 mysql 是执行命令，第二个 mysql 是系统数据名称，不一样的。）</p>\n<p>②设置权限：</p>\n<p>赋予权限格式： grant 权限 on 数据库对象 to 用户 @IP (或者相应正则)</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token comment\">-- 新建用户规则或者直接修改root用户的规则 ，2 选一</span>\n<span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">-- 这里表示赋予该用户所有数据库所有表（*.*表示所有表），%表示所有IP地址。</span>\n<span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">ALL</span> <span class=\"token keyword\">PRIVILEGES</span> <span class=\"token keyword\">ON</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">TO</span> <span class=\"token string\">'root'</span><span class=\"token variable\">@'%'</span> IDENTIFIED <span class=\"token keyword\">BY</span> <span class=\"token string\">'123456'</span> <span class=\"token keyword\">WITH</span> <span class=\"token keyword\">GRANT</span> <span class=\"token keyword\">OPTION</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">-- 使root能再任何host访问</span>\n<span class=\"token keyword\">update</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">set</span> host <span class=\"token operator\">=</span> <span class=\"token string\">'%'</span> <span class=\"token keyword\">where</span> <span class=\"token keyword\">user</span> <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span>      \n\n<span class=\"token comment\">-- 刷新</span>\nFLUSH <span class=\"token keyword\">PRIVILEGES</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>③查看：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">use</span> mysql<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> HOST<span class=\"token punctuation\">,</span><span class=\"token keyword\">USER</span> <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">USER</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<img src=\"/:/post/MySQL_Create/920952e9041b4af1a8a49eb64e0f4430.jpeg\" class=\"\" title=\"img\">\n<p>④退出 mysql：quit;</p>\n<h2 id=\"其他安装方式\"><a class=\"markdownIt-Anchor\" href=\"#其他安装方式\">#</a> 其他安装方式</h2>\n<h3 id=\"docker\"><a class=\"markdownIt-Anchor\" href=\"#docker\">#</a> docker</h3>\n<h4 id=\"1-查询镜像\"><a class=\"markdownIt-Anchor\" href=\"#1-查询镜像\">#</a> 1、查询镜像</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> search mysql<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"2-拉取镜像\"><a class=\"markdownIt-Anchor\" href=\"#2-拉取镜像\">#</a> 2、拉取镜像</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> pull mysql:5.7<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h4 id=\"3-构建容器\"><a class=\"markdownIt-Anchor\" href=\"#3-构建容器\">#</a> 3、构建容器</h4>\n<p>先自己创建配置文件基础模板（<strong>要是后期要修改配置文件必须加入 模板中的两个元素，不然容器启动会出错</strong>）</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /root/mysql/conf\n<span class=\"token function\">vim</span>  /root/mysql/conf/my.cnf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><strong>模板内容：</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token operator\">!</span>includedir /etc/mysql/conf.d/\n<span class=\"token operator\">!</span>includedir /etc/mysql/mysql.conf.d/\n\n<span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\ndefault-character-set<span class=\"token operator\">=</span>utf8mb4\n<span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">character_set_server</span><span class=\"token operator\">=</span>utf8mb4\n<span class=\"token assign-left variable\">init_connect</span><span class=\"token operator\">=</span><span class=\"token string\">'SET NAMES utf8'</span>\nlower_case_table_names <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>构建容器</strong></p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> run <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-p</span> <span class=\"token number\">3306</span>:3306 <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-v</span> /root/mysql/data:/var/lib/mysql <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-v</span> /root/mysql/logs:/logs <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-v</span> /root/mysql/conf/my.cnf:/etc/mysql/my.cnf <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-e</span> <span class=\"token assign-left variable\">MYSQL_ROOT_PASSWORD</span><span class=\"token operator\">=</span>root <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--name</span> mysql <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--hostname</span> node1 <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">--restart</span><span class=\"token operator\">=</span>always <span class=\"token punctuation\">\\</span>\n<span class=\"token parameter variable\">-d</span> mysql:5.7<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>注</strong>：出错时将本地映射文件检查一下，要是不需要配置，只需映射直接删掉就可，以后再改配置文件</p>\n<h4 id=\"4-进入容器\"><a class=\"markdownIt-Anchor\" href=\"#4-进入容器\">#</a> 4、进入容器</h4>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql /bin/bash\n或者\n<span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> <span class=\"token parameter variable\">-it</span> mysql mysql <span class=\"token parameter variable\">-uroot</span> <span class=\"token parameter variable\">-p</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"docker-compose\"><a class=\"markdownIt-Anchor\" href=\"#docker-compose\">#</a> docker-compose</h3>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>前提安装了 docker-compose</p></blockquote>\n<h4 id=\"配置-docker-comoseyml-文件\"><a class=\"markdownIt-Anchor\" href=\"#配置-docker-comoseyml-文件\">#</a> 配置  docker-comose.yml 文件</h4>\n<p>5.7：</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>5.7.32\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db57\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql\n      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf\n      <span class=\"token comment\"># 数据库初始化脚本，当Mysql容器首次启动时，会在 /docker-entrypoint-initdb.d目录下扫描 .sh，.sql，.sql.gz类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span>\n      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456\n      <span class=\"token comment\"># 指定初始化sql文件的数据库，简单来书就是新建一个数据库</span>\n      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db\n      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 3311<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>8.0</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"3.0\"</span>\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">mysql8</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mysql<span class=\"token punctuation\">:</span>8.0.25\n    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> my_db8\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./db<span class=\"token punctuation\">:</span>/var/lib/mysql\n      <span class=\"token punctuation\">-</span> ./conf/my.cnf<span class=\"token punctuation\">:</span>/etc/my.cnf\n      <span class=\"token comment\"># 数据库初始化脚本，当Mysql容器首次启动时，会在 /docker-entrypoint-initdb.d目录下扫描 .sh，.sql，.sql.gz类型的文件。如果这些类型的文件存在，将执行它们来初始化一个数据库；</span>\n      <span class=\"token punctuation\">-</span> ./init/<span class=\"token punctuation\">:</span>/docker<span class=\"token punctuation\">-</span>entrypoint<span class=\"token punctuation\">-</span>initdb.d/\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> MYSQL_ROOT_PASSWORD=123456\n      <span class=\"token comment\"># 指定初始化sql文件的数据库，简单来书就是新建一个数据库</span>\n      <span class=\"token punctuation\">-</span> MYSQL_DATABASE=my_db\n      <span class=\"token punctuation\">-</span> TZ=Asia/Shanghai\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 3301<span class=\"token punctuation\">:</span><span class=\"token number\">3306</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"配置文件-mycnf\"><a class=\"markdownIt-Anchor\" href=\"#配置文件-mycnf\">#</a> 配置文件 my.cnf</h4>\n<p>5.7：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 设置mysql客户端默认字符集</span>\ndefault-character-set<span class=\"token operator\">=</span>utf8mb4\n\n<span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">datadir</span><span class=\"token operator\">=</span>/var/lib/mysql\n<span class=\"token assign-left variable\">socket</span><span class=\"token operator\">=</span>/var/lib/mysql/mysql.sock\n\nsymbolic-links<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\nlog-error<span class=\"token operator\">=</span>/var/log/mysqld.log\npid-file<span class=\"token operator\">=</span>/var/run/mysqld/mysqld.pid\n<span class=\"token comment\"># 服务端使用的字符集默认为8比特编码的latin1字符集</span>\ncharacter-set-server<span class=\"token operator\">=</span>utf8mb4\n\n<span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span>\ndefault-storage-engine<span class=\"token operator\">=</span>INNODB<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>8.0：</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 设置mysql客户端默认字符集</span>\ndefault-character-set<span class=\"token operator\">=</span>utf8mb4\n<span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 允许最大连接数</span>\n<span class=\"token assign-left variable\">max_connections</span><span class=\"token operator\">=</span><span class=\"token number\">200</span>\n\n<span class=\"token comment\"># 服务端使用的字符集默认为8比特编码的latin1字符集</span>\ncharacter-set-server<span class=\"token operator\">=</span>utf8mb4\n\n<span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span>\ndefault-storage-engine<span class=\"token operator\">=</span>INNODB<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"问题\"><a class=\"markdownIt-Anchor\" href=\"#问题\">#</a> 问题</h4>\n<p>1、Can’t create/write to file '/var/run/mysqld/mysqld.pid</p>\n<p>去配置文件中找到 errorlog 的地址，查看错误日志</p>\n<img src=\"/:/post/MySQL_Create/20190602012200812.png\" class=\"\" title=\"img\">\n<p>错误原因为：/var/run/mysqld/ 目录的拥有者为 root，mysql 不能在其中创建文件</p>\n<p>使用如下命令修改目录使用者</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token comment\"># 先查看目录是否存在</span>\n<span class=\"token function\">ls</span> <span class=\"token parameter variable\">-ld</span> /var/run/mysqld/\n<span class=\"token comment\"># 权限</span>\n<span class=\"token function\">chown</span> mysql.mysql /var/run/mysqld/\n<span class=\"token comment\"># 修改后重启mysql服务</span>\n/etc/init.d/mysqld start<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","feature":true,"text":"# MySQL 安装 # 1、卸载原来的版本 # 1、查看 mysql 的安装情况 rpm -qa | grep -i mysql # 2、删除上图安装的软件 rpm -ev --nodeps mysql57-community-release-el5-7.noarch rpm ...","link":"","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"数据库","slug":"数据库","count":3,"path":"api/categories/数据库.json"},{"name":"MySQL","slug":"数据库/MySQL","count":2,"path":"api/categories/数据库/MySQL.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":2,"path":"api/tags/MySQL.json"},{"name":"数据库基础","slug":"数据库基础","count":1,"path":"api/tags/数据库基础.json"},{"name":"数据库基本知识","slug":"数据库基本知识","count":1,"path":"api/tags/数据库基本知识.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#mysql%E5%AE%89%E8%A3%85\"><span class=\"toc-text\"> MySQL 安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%8D%B8%E8%BD%BD%E5%8E%9F%E6%9D%A5%E7%9A%84%E7%89%88%E6%9C%AC\"><span class=\"toc-text\"> 1、卸载原来的版本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E6%9F%A5%E7%9C%8Bmysql%E7%9A%84%E5%AE%89%E8%A3%85%E6%83%85%E5%86%B5\"><span class=\"toc-text\"> 1、查看 mysql 的安装情况</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E5%88%A0%E9%99%A4%E4%B8%8A%E5%9B%BE%E5%AE%89%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6\"><span class=\"toc-text\"> 2、删除上图安装的软件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E9%83%BD%E5%88%A0%E9%99%A4%E6%88%90%E5%8A%9F%E4%B9%8B%E5%90%8E%E6%9F%A5%E6%89%BE%E7%9B%B8%E5%85%B3%E7%9A%84mysql%E7%9A%84%E6%96%87%E4%BB%B6\"><span class=\"toc-text\"> 3、都删除成功之后，查找相关的 mysql 的文件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E5%88%A0%E9%99%A4%E5%85%A8%E9%83%A8%E6%96%87%E4%BB%B6\"><span class=\"toc-text\"> 4、删除全部文件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5-%E5%86%8D%E6%AC%A1%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\"> 5、再次执行命令</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E5%88%A0%E9%99%A4mariadb-libs%E4%B8%8D%E5%8F%AF%E7%9C%81%E7%95%A5\"><span class=\"toc-text\"> 2、删除 mariadb-libs (不可省略)</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E5%AE%89%E8%A3%85mysql\"><span class=\"toc-text\"> 3、安装 MySQL</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E8%BE%93%E5%85%A5\"><span class=\"toc-text\"> 1，输入</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E5%AE%89%E8%A3%85%E6%95%B0%E6%8D%AE%E6%BA%90\"><span class=\"toc-text\"> 2、安装数据源</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-%E6%9F%A5%E7%9C%8Bmysql%E6%BA%90%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F\"><span class=\"toc-text\"> 3、查看 mysql 源是否安装成功</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-%E5%AE%89%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\"> 4、安装数据库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5-%E5%90%AF%E5%8A%A8mysql\"><span class=\"toc-text\"> 5、启动 mysql</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#6-%E6%98%BE%E7%A4%BAmysql%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%AF%86%E7%A0%81\"><span class=\"toc-text\"> 6、显示 mysql 的随机密码</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#7-%E7%99%BB%E5%BD%95%E5%B9%B6%E4%BF%AE%E6%94%B9mysql%E5%AF%86%E7%A0%81\"><span class=\"toc-text\"> 7、登录并修改 mysql 密码</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\"> 4、其他配置</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF\"><span class=\"toc-text\"> 1. 开机自启</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\"> 2. 远程连接</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7-%E6%94%AF%E6%8C%81%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\"> 方法一、创建一个用户 支持远程连接</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C-%E8%AE%BE%E7%BD%AEroot%E7%94%A8%E6%88%B7%E6%94%AF%E6%8C%81%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5\"><span class=\"toc-text\"> 方法二、设置 root 用户支持远程连接</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\"> 其他安装方式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#docker\"><span class=\"toc-text\"> docker</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-%E6%9F%A5%E8%AF%A2%E9%95%9C%E5%83%8F\"><span class=\"toc-text\"> 1、查询镜像</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F\"><span class=\"toc-text\"> 2、拉取镜像</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-%E6%9E%84%E5%BB%BA%E5%AE%B9%E5%99%A8\"><span class=\"toc-text\"> 3、构建容器</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8\"><span class=\"toc-text\"> 4、进入容器</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#docker-compose\"><span class=\"toc-text\"> docker-compose</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE-docker-comoseyml-%E6%96%87%E4%BB%B6\"><span class=\"toc-text\"> 配置  docker-comose.yml 文件</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-mycnf\"><span class=\"toc-text\"> 配置文件 my.cnf</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%97%AE%E9%A2%98\"><span class=\"toc-text\"> 问题</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"雾都","slug":"blog-author","avatar":"https://portrait.gitee.com/uploads/avatars/user/3314/9943015_zjj3366_1635594784.png!avatar100","link":"/","description":"","socials":{"github":"https://github.com/onlymarryu","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Errors","uid":"cea14d737db47f57fc4740d2a49418b4","slug":"Errors","date":"2022-10-08T08:48:12.000Z","updated":"2022-10-08T08:55:06.240Z","comments":true,"path":"api/articles/Errors.json","keywords":"java","cover":null,"text":"所有文章的 cover 没有设置，再次访问的时候，自己设置一下 格式： --- *** cover: 图床的链接 | 本地地址 (根目录是source) --- ","link":"","photos":[],"count_time":{"symbolsCount":84,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"雾都","slug":"blog-author","avatar":"https://portrait.gitee.com/uploads/avatars/user/3314/9943015_zjj3366_1635594784.png!avatar100","link":"/","description":"","socials":{"github":"https://github.com/onlymarryu","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"MySQL基础","uid":"4a207b7e885fdbcca8129599135e5f2e","slug":"Docsify","date":"2022-10-08T07:10:27.998Z","updated":"2022-10-07T13:28:29.476Z","comments":true,"path":"api/articles/Docsify.json","keywords":"java","cover":[],"text":"# Docsify 搭建 官网：https://docsify.js.org/#/zh-cn/ 前提 要配置好 nodeJs 、 npm # 安装 Docsify 插件 自己创建一个要下载到本地的文件夹，然后在这里直接利用命令下载 推荐全局安装 docsify-cli 工具，可以...","link":"","photos":[],"count_time":{"symbolsCount":"4.5k","symbolsTime":"4 mins."},"categories":[{"name":"基础使用","slug":"基础使用","count":2,"path":"api/categories/基础使用.json"}],"tags":[{"name":"博客","slug":"博客","count":2,"path":"api/tags/博客.json"},{"name":"环境搭建","slug":"环境搭建","count":1,"path":"api/tags/环境搭建.json"}],"author":{"name":"雾都","slug":"blog-author","avatar":"https://portrait.gitee.com/uploads/avatars/user/3314/9943015_zjj3366_1635594784.png!avatar100","link":"/","description":"","socials":{"github":"https://github.com/onlymarryu","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}